# Telegraf Configuration for SNMP Monitoring

[global_tags]
  service = "telegraf-snmp"
  environment = "production"

[agent]
  interval = "${TELEGRAF_SNMP_INTERVAL:-30s}"
  round_interval = true
  metric_batch_size = 1000
  metric_buffer_limit = 10000
  collection_jitter = "0s"
  flush_interval = "10s"
  flush_jitter = "0s"
  hostname = ""
  omit_hostname = false
  debug = ${TELEGRAF_DEBUG:-false}
  quiet = ${TELEGRAF_QUIET:-false}

[[outputs.influxdb_v2]]
  urls = ["${INFLUX_URL:-http://influxdb:8086}"]
  token = "${INFLUX_TOKEN}"
  organization = "${INFLUX_ORG}"
  bucket = "${INFLUX_BUCKET}"
  timeout = "30s"

# SNMP Input Plugin
[[inputs.snmp]]
  # List of agents to poll (will be updated by configure script)
  agents = ["192.168.1.10:161","192.168.1.1:161"]
  
  # Timeout for each request
  timeout = "10s"
  
  # SNMP version (1, 2c, 3)
  version = ${TELEGRAF_SNMP_VERSION:-2c}
  
  # SNMP community string (for v1 and v2c)
  community = "${TELEGRAF_SNMP_COMMUNITY:-public}"
  
  # Number of retries
  retries = 3
  
  # SNMP v3 auth parameters (uncomment if using SNMPv3)
  #sec_name = "${TELEGRAF_SNMP_SEC_NAME}"
  #auth_protocol = "${TELEGRAF_SNMP_AUTH_PROTOCOL}"
  #auth_password = "${TELEGRAF_SNMP_AUTH_PASSWORD}"
  #sec_level = "${TELEGRAF_SNMP_SEC_LEVEL}"
  #priv_protocol = "${TELEGRAF_SNMP_PRIV_PROTOCOL}"
  #priv_password = "${TELEGRAF_SNMP_PRIV_PASSWORD}"

  # measurement name
  name = "snmp"

  [[inputs.snmp.field]]
    name = "host_desc"
    oid = "1.3.6.1.2.1.1.1.0"
    is_tag = true

  [[inputs.snmp.table]]
    name = "net"
    oid = "1.3.6.1.2.1.2.2"

  # ThÃªm field cho Cisco CPU Usage OID
  [[inputs.snmp.field]]
    name = "cisco_cpu_load_avg" 
    oid = "1.3.6.1.4.1.9.6.1.101.1.9.0"

# Internal metrics
[[inputs.internal]]
  collect_memstats = true